---
title: "EinfÃ¼hrung in R & RStudio â€“ Tag 2"
subtitle: "Fehlende Werte, Umkodieren & Workflows"
format:
  html:
    toc: true
    toc-title: "Tag 2 â€“ Inhalte"
    toc-location: left
    toc-depth: 2

    
sidebar: workshop1
---

Willkommen zurÃ¼ck ğŸ‘‹  
Wir starten mit einem kurzen Recap von Tag 1 und klÃ¤ren offene Fragen.

# Recap - Tag 1

Wir haben im ersten Teil des Workshops gelernt, wie RStudio aufgebaut ist und funktioniert. Wir kennen nun die wichtigsten Grundlagen und kÃ¶nnen diese heute weiter **vertiefen und festigen**.

::: callout-tip
# **Recap-Fragen**
- Was ist ein Data Frame?
- Was macht `select()` vs. `filter()`?
- WofÃ¼r nutzen wir Pipes (`|>`)?
:::

::: callout-note
# **Merksatz**

R ist eine **Programmiersprache** â€“ und wie jede Sprache lernt man sie  
durch **regelmÃ¤ÃŸige Nutzung**.

Fehler zu machen ist vÃ¶llig normal (auch wenn es manchmal frustrierend ist).  
FÃ¼r fast jedes Problem gibt es **eine LÃ¶sung, eine ErklÃ¤rung oder ein Paket** ğŸ˜Š
:::

___

# Umkodieren

In der Datenanalyse arbeiten wir hÃ¤ufig mit Variablen,  
deren Werte **nicht direkt so vorliegen**, wie wir sie fÃ¼r eine Auswertung benÃ¶tigen.

**Umkodieren** bedeutet, bestehende Variablen so zu verÃ¤ndern oder neu zu definieren,  
dass sie **inhaltlich sinnvoll** und **analytisch nutzbar** werden.

Beim Umkodieren kÃ¶nnen zum Beispiel:

- Kategorien zusammengefasst werden  
  (z. B. mehrere BildungsabschlÃ¼sse â†’ â€niedrig / mittel / hochâ€œ)
- Werte umgedreht werden  
  (z. B. hohe Werte = geringe Zustimmung)
- neue Variablen aus bestehenden gebildet werden  
  (z. B. Summen- oder Skalenwerte) **â†’** das kennen wir schon!

::: callout-tip
# **Warum ist Umkodieren wichtig?**

Rohdaten sind selten sofort â€analysefertigâ€œ.  
Durch Umkodieren stellen wir sicher,  
dass unsere Variablen **inhaltlich korrekt** interpretiert  
und **vergleichbar** ausgewertet werden kÃ¶nnen. Umkodierung ist daher ein wichtiger **Bestandteil der Datenaufbereitung** und **wichtig** fÃ¼r die spÃ¤teren Analysen!
:::

Im Folgenden sehen wir typische Beispiele fÃ¼r Umkodierungen  
und setzen sie direkt mit R um.

## Umkodieren invertierter Items

In FragebÃ¶gen kommen hÃ¤ufig invertierte Items vor. Das bedeutet: Hohe Werte drÃ¼cken geringe Zustimmung aus â€“ oder umgekehrt.

Damit alle Items in dieselbe Richtung zeigen, mÃ¼ssen invertierte Items umkodiert werden.

### Beispiel 

Die Items `hs04` bis `hs07 und hs09` Fragen die mentale Gesundheit in den letzten vier Wochen ab:

|**Variable**|**Inhalt**|**Skalierung**|
|----|----|----|
|hs04|"Hetze, unter Zeitdruck"| 1 = "Immer" bis 5 = "Nie"|
|hs05|"Niedergeschlage"| 1 = "Immer" bis 5 = "Nie"|
|hs06|"Ruhig, Ausgeglichen"| 1 = "Immer" bis 5 = "Nie"|
|hs07|"Jede menge Energie"| 1 = "Immer" bis 5 = "Nie"|
|hs09|"Einsam"|1 = "Immer" bis 5 = "Nie"|

Wir wir sehen, sind einige Items invertiert formuliert. WÃ¼rden wir daraus, eine Skala bilden bspw. **Disstress**, kÃ¶nnten wir mit dem `mutate()`Befehl, keine adÃ¤quate Skala bilden.

Wir mÃ¼ssen also entscheiden, was nun **hohe Werte und was niedrige Werte** darstellen sollen. Damit es intuitiver ist, wollen wir nun die **Variablen `hs04`, `hs05` und `hs09`umkodieren**, damit spÃ¤ter es hoher Wert auf der Skala **"viel Disstress"** darstellen kann.

Doch bevor wir Anfangen, laden wir zunÃ¤chst unseren Datensatz und die Pakte wieder ein, bzw. haben diese schon im Environment!

```{r}
#| echo: true
#| warning: false

library(tidyverse)

df_csv <- read_csv("assets/data/datensatz_workshop.csv")

head(df_csv, 10)
```

Zum besseren VerstÃ¤ndnis verkleinern wir erstmal unseren Datensatz: Erstelle den Datensatz `df_diss` mit nur den Items die wir benÃ¶tigen.

:::{.callout-tip collapse="true"}
# LÃ¶sung

```{r}

df_diss <- df_csv |>
select(hs04,hs05,hs06,hs07,hs09)

head(df_diss, 10)

```

:::

Nun kÃ¶nnen wir in diesem neuen Datensatz, getrennt von den Rohdaten, Ã¼ben!

:::{.panel-tabset}

# Alternative 1

```{r}
#| echo: true

# jede Variable einzeln und manuell

df_diss$hs04_inv <- 6 - df_diss$hs04

head(df_diss$hs04,10)

head(df_diss$hs04_inv,10)
```
:::{.callout-tip collapse="true"}
# **Hinweis**
Bei der Intertierung, wird...
- der Wert`1` zu  `5`
- der Wert `2` zu `4`
- der Wert `3`bleibt `3`
- der Wert `4` zu `2`
- der Wert `5` zu `1`

Die oben vorgstellte **Alternative 1** basiert auf der Annahme **"maximaler Skalenwert" + 1 - "Skalenwert der Person"**.
:::

# Alternative 2

```{r}
#| echo: true

 df_diss<-df_diss|>
    mutate(hs04_inv = recode(hs04,
                             "1"=5,
                             "2"=4,
                             "3"=3,
                             "4"=2,
                             "5"=1),
           hs05_inv = recode(hs05,
                             "1"=5,
                             "2"=4,
                             "3"=3,
                             "4"=2,
                             "5"=1),
           hs09_inv = recode(hs09,
                            "1"=5,
                            "2"=4,
                            "3"=3,
                            "4"=2,
                            "5"=1),
           )

head(df_diss, 10)           
```

# Alternative 3

```{r}
#| echo: true
#| warning: false
#| eval: false

install.packages("sjmisc")

```
```{r}
#| echo: true
#| warning: false

library(sjmisc)

df_diss <- df_diss|>
mutate(hs04_inv = rec(hs04, rec = "rev"),
hs05_inv = rec(hs05, rec = "rev"),
hs09_inv = rec(hs09, rec = "rev"))

head(df_diss, 10)

```
:::{.callout-tip collapse="true"}
# **Hinweis**
Wir haben hier einen Befehl aus einem anderen Paket genutzt. Wie du sehen kannst, sind Pakete auch miteinander kombinierbar!

Hier handelt es sich um den `rec()` Befehl aus dem Paket **sjmisc**.
:::
:::




# Fehlende Werte (NA)

Warum fehlende Werte wichtig sind, wie man sie erkennt und sinnvoll behandelt.

___

# Umkodieren

Wie wir Variablen neu kodieren (z. B. Kategorien zusammenfassen, Werte umdrehen, Skalen bilden).

___

# Joins

Wie wir DatensÃ¤tze Ã¼ber eine gemeinsame ID zusammenfÃ¼hren (z. B. `left_join()`).

___

# Reproduzierbare Workflows

Ordnerstruktur, Skripte, klare Dateinamen, Outputs â€“ damit Analysen nachvollziehbar bleiben.

___

# Mini-Projekt

Wir kombinieren alles: Import â†’ Check â†’ Missing â†’ Recodes â†’ Join â†’ Export.
